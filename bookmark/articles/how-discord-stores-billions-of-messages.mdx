---
title: How Discord Stores Billions of Messages
---

# [How Discord Stores Billions of Messages](https://discord.com/blog/how-discord-stores-billions-of-messages)

- Discord는 2015년 5월에 출시됨.
  - ~~기능을 입증하기 위해 빠르게 개발하는 것이 문화기에~~ 두 달동안 주요 기능을 개발했고 데이터베이스로 MongoDB 레플리카 셋 1개로 구성함.
  - (그 당시) MongoDB 샤딩을 사용하는 것이 복잡하기도 했고 나중에 쉽게 마이그레이션을 하기 위해 단일 레플리카 셋으로 구성함.
  - 이 때 메시지 데이터는 `(channel_id, created_at)`을 단일 복합 인덱스로 하여 저장함.
- 2015년 11월쯤 하루 1억개의 메시지가 저장되었고 성능 이슈가 발생하기 시작.
  - Discord는 모든 메시지를 저장하고 몇 년이 지난 사용자가 다시 돌아와도 모든 메시지 히스토리를 확인할 수 있음.
  - 그래서 [Cassandra](https://cassandra.apache.org/_/index.html)로 데이터베이스를 바꿨고 성공적으로 마이그레이션됨!
    - Cassandra는 지연 시간이 짧고, 스키마가 유연하고, read보다는 write가 더 빠르다는 특징이 있음.
  - (2017년 당시) 12개의 노드 클러스터와 레플리카 팩터(Replica Factor)를 3으로 설정했고 필요에 따라 노드를 추가하는 방식으로 운영함.
